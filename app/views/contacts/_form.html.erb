<%= form_with(model: [establishment, establishment_tracking, contact], local: true, class: "fr-mb-3w") do |f| %>
  <div class="fr-input-group <%= @contact.errors[:first_name].any? ? 'fr-input-group--error' : '' %>">
    <%= f.label :first_name, "Prénom", class: "fr-label" %>
    <%= f.text_field :first_name,
                     class: "fr-input #{ @contact.errors[:first_name].any? ? 'fr-input--error' : '' }",
                     'aria-describedby': @contact.errors[:first_name].any? ? "first-name-error" : nil %>
    <% if @contact.errors[:first_name].any? %>
      <p id="first-name-error" class="fr-error-text">
        <%= @contact.errors[:first_name].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-input-group <%= @contact.errors[:last_name].any? ? 'fr-input-group--error' : '' %>">
    <%= f.label :last_name, "Nom", class: "fr-label" %>
    <%= f.text_field :last_name,
                     class: "fr-input #{ @contact.errors[:last_name].any? ? 'fr-input--error' : '' }",
                     'aria-describedby': @contact.errors[:last_name].any? ? "last-name-error" : nil %>
    <% if @contact.errors[:last_name].any? %>
      <p id="last-name-error" class="fr-error-text">
        <%= @contact.errors[:last_name].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-input-group <%= @contact.errors[:role].any? ? 'fr-input-group--error' : '' %>">
    <%= f.label :role, "Fonction", class: "fr-label" %>
    <%= f.select :role, ['Dirigeant', 'DAF', 'DRH', 'Autre'], {},
                 class: "fr-select #{ @contact.errors[:role].any? ? 'fr-input--error' : '' }" %>
    <% if @contact.errors[:role].any? %>
      <p class="fr-error-text">
        <%= @contact.errors[:role].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-input-group <%= @contact.errors[:phone_number_primary].any? ? 'fr-input-group--error' : '' %>">
    <%= f.label :phone_number_primary, "Numéro de téléphone principal", class: "fr-label" %>
    <%= f.telephone_field :phone_number_primary,
                          class: "fr-input #{ @contact.errors[:phone_number_primary].any? ? 'fr-input--error' : '' }",
                          'aria-describedby': @contact.errors[:phone_number_primary].any? ? "phone-number-primary-error" : nil %>
    <% if @contact.errors[:phone_number_primary].any? %>
      <p id="phone-number-primary-error" class="fr-error-text">
        <%= @contact.errors[:phone_number_primary].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-input-group <%= @contact.errors[:phone_number_secondary].any? ? 'fr-input-group--error' :  '' %>">
    <%= f.label :phone_number_secondary, "Numéro de téléphone secondaire", class: "fr-label" %>
    <%= f.telephone_field :phone_number_secondary,
                          class: "fr-input #{ @contact.errors[:phone_number_secondary].any? ? 'fr-input--error' :  '' }",
                          'aria-describedby': @contact.errors[:phone_number_secondary].any? ? "phone-number-secondary-error" : nil %>
    <% if @contact.errors[:phone_number_secondary].any? %>
      <p id="phone-number-secondary-error" class="fr-error-text">
        <%= @contact.errors[:phone_number_secondary].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-input-group <%= @contact.errors[:email].any? ? 'fr-input-group--error' :  '' %>">
    <%= f.label :email, "Adresse email", class: "fr-label" %>
    <%= f.email_field :email,
                      class: "fr-input #{ @contact.errors[:email].any? ? 'fr-input--error' : '' }",
                      'aria-describedby': @contact.errors[:email].any? ? "email-error" : nil %>
    <% if @contact.errors[:email].any? %>
      <p id="email-error" class="fr-error-text">
        <%= @contact.errors[:email].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-input-group <%= @contact.errors[:description].any? ? 'fr-input-group--error' : '' %>">
    <%= f.label :description, "Notes de contact", class: "fr-label" %>
    <%= f.text_area :description,
                     class: "fr-input #{ @contact.errors[:description].any? ? 'fr-input--error' : '' }",
                     'aria-describedby': @contact.errors[:description].any? ? "last-name-error" : nil %>
    <% if @contact.errors[:description].any? %>
      <p id="last-name-error" class="fr-error-text">
        <%= @contact.errors[:description].join(', ') %>
      </p>
    <% end %>
  </div>

  <div class="fr-btn-group">
    <%= link_to "Annuler", establishment_establishment_tracking_path(@establishment, @establishment_tracking), class: "fr-btn fr-btn--secondary" %>
    <%= f.submit "Enregistrer", class: "fr-btn" %>
    <% if @contact.persisted? %>
        <%= link_to 'Supprimer',
                    archive_establishment_establishment_tracking_contact_path(@establishment, @establishment_tracking, contact),
                    class: 'fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-icon-folder-2-line',
                    data: { turbo: false } %>
    <% end %>
  </div>
<% end %>
